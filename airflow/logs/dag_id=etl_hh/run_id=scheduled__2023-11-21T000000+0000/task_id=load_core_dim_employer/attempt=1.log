[2023-11-22 06:34:08,617] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: etl_hh.load_core_dim_employer scheduled__2023-11-21T00:00:00+00:00 [queued]>
[2023-11-22 06:34:08,645] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: etl_hh.load_core_dim_employer scheduled__2023-11-21T00:00:00+00:00 [queued]>
[2023-11-22 06:34:08,647] {taskinstance.py:1376} INFO - 
--------------------------------------------------------------------------------
[2023-11-22 06:34:08,648] {taskinstance.py:1377} INFO - Starting attempt 1 of 2
[2023-11-22 06:34:08,649] {taskinstance.py:1378} INFO - 
--------------------------------------------------------------------------------
[2023-11-22 06:34:08,679] {taskinstance.py:1397} INFO - Executing <Task(PostgresOperator): load_core_dim_employer> on 2023-11-21 00:00:00+00:00
[2023-11-22 06:34:08,689] {standard_task_runner.py:52} INFO - Started process 272 to run task
[2023-11-22 06:34:08,695] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'etl_hh', 'load_core_dim_employer', 'scheduled__2023-11-21T00:00:00+00:00', '--job-id', '9', '--raw', '--subdir', 'DAGS_FOLDER/pipeline.py', '--cfg-path', '/tmp/tmp6pxvxcmy', '--error-file', '/tmp/tmps_0dov37']
[2023-11-22 06:34:08,697] {standard_task_runner.py:80} INFO - Job 9: Subtask load_core_dim_employer
[2023-11-22 06:34:08,837] {task_command.py:371} INFO - Running <TaskInstance: etl_hh.load_core_dim_employer scheduled__2023-11-21T00:00:00+00:00 [running]> on host 9ac5eb002233
[2023-11-22 06:34:09,013] {taskinstance.py:1591} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=etl_hh
AIRFLOW_CTX_TASK_ID=load_core_dim_employer
AIRFLOW_CTX_EXECUTION_DATE=2023-11-21T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-11-21T00:00:00+00:00
[2023-11-22 06:34:09,032] {base.py:68} INFO - Using connection ID 'my_db_conn' for task execution.
[2023-11-22 06:34:09,071] {dbapi.py:231} INFO - Running statement: 
        MERGE INTO core.dim_employer AS trg
        USING(
            SELECT DISTINCT 
                employer_id,
                employer_name
            FROM staging.vacancy) AS src
        ON trg.employer_id = src.employer_id
        WHEN NOT MATCHED
        THEN INSERT(
            employer_id,
            name)
        VALUES(
            src.employer_id,
            src.employer_name)
        WHEN MATCHED
                AND (COALESCE(trg.name, '') <> COALESCE(src.employer_name, '')
                OR trg.employer_id <> src.employer_id)
        THEN UPDATE
        SET 
            employer_id = src.employer_id, 
            name = src.employer_name, parameters: None
[2023-11-22 06:34:09,127] {taskinstance.py:1420} INFO - Marking task as SUCCESS. dag_id=etl_hh, task_id=load_core_dim_employer, execution_date=20231121T000000, start_date=20231122T063408, end_date=20231122T063409
[2023-11-22 06:34:09,188] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-11-22 06:34:09,309] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-11-22 19:13:47,803] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: etl_hh.load_core_dim_employer scheduled__2023-11-21T00:00:00+00:00 [queued]>
[2023-11-22 19:13:47,838] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: etl_hh.load_core_dim_employer scheduled__2023-11-21T00:00:00+00:00 [queued]>
[2023-11-22 19:13:47,839] {taskinstance.py:1376} INFO - 
--------------------------------------------------------------------------------
[2023-11-22 19:13:47,840] {taskinstance.py:1377} INFO - Starting attempt 1 of 2
[2023-11-22 19:13:47,841] {taskinstance.py:1378} INFO - 
--------------------------------------------------------------------------------
[2023-11-22 19:13:47,897] {taskinstance.py:1397} INFO - Executing <Task(PostgresOperator): load_core_dim_employer> on 2023-11-21 00:00:00+00:00
[2023-11-22 19:13:47,907] {standard_task_runner.py:52} INFO - Started process 470 to run task
[2023-11-22 19:13:47,916] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'etl_hh', 'load_core_dim_employer', 'scheduled__2023-11-21T00:00:00+00:00', '--job-id', '49', '--raw', '--subdir', 'DAGS_FOLDER/pipeline.py', '--cfg-path', '/tmp/tmpiqyhig1r', '--error-file', '/tmp/tmp4tniigsn']
[2023-11-22 19:13:47,918] {standard_task_runner.py:80} INFO - Job 49: Subtask load_core_dim_employer
[2023-11-22 19:13:48,078] {task_command.py:371} INFO - Running <TaskInstance: etl_hh.load_core_dim_employer scheduled__2023-11-21T00:00:00+00:00 [running]> on host 9ac5eb002233
[2023-11-22 19:13:48,310] {taskinstance.py:1591} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=etl_hh
AIRFLOW_CTX_TASK_ID=load_core_dim_employer
AIRFLOW_CTX_EXECUTION_DATE=2023-11-21T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-11-21T00:00:00+00:00
[2023-11-22 19:13:48,333] {base.py:68} INFO - Using connection ID 'my_db_conn' for task execution.
[2023-11-22 19:13:48,367] {dbapi.py:231} INFO - Running statement: 
        MERGE INTO core.dim_employer AS trg
        USING(
            SELECT DISTINCT 
                employer_id,
                employer_name
            FROM staging.vacancy) AS src
        ON trg.employer_id = src.employer_id
        WHEN NOT MATCHED
        THEN INSERT(
            employer_id,
            name)
        VALUES(
            src.employer_id,
            src.employer_name)
        WHEN MATCHED
                AND (COALESCE(trg.name, '') <> COALESCE(src.employer_name, '')
                OR trg.employer_id <> src.employer_id)
        THEN UPDATE
        SET 
            employer_id = src.employer_id, 
            name = src.employer_name, parameters: None
[2023-11-22 19:13:48,416] {taskinstance.py:1420} INFO - Marking task as SUCCESS. dag_id=etl_hh, task_id=load_core_dim_employer, execution_date=20231121T000000, start_date=20231122T191347, end_date=20231122T191348
[2023-11-22 19:13:48,492] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-11-22 19:13:48,616] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2023-11-22 19:16:36,364] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: etl_hh.load_core_dim_employer scheduled__2023-11-21T00:00:00+00:00 [queued]>
[2023-11-22 19:16:36,390] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: etl_hh.load_core_dim_employer scheduled__2023-11-21T00:00:00+00:00 [queued]>
[2023-11-22 19:16:36,391] {taskinstance.py:1376} INFO - 
--------------------------------------------------------------------------------
[2023-11-22 19:16:36,392] {taskinstance.py:1377} INFO - Starting attempt 1 of 2
[2023-11-22 19:16:36,393] {taskinstance.py:1378} INFO - 
--------------------------------------------------------------------------------
[2023-11-22 19:16:36,439] {taskinstance.py:1397} INFO - Executing <Task(PostgresOperator): load_core_dim_employer> on 2023-11-21 00:00:00+00:00
[2023-11-22 19:16:36,447] {standard_task_runner.py:52} INFO - Started process 594 to run task
[2023-11-22 19:16:36,451] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'etl_hh', 'load_core_dim_employer', 'scheduled__2023-11-21T00:00:00+00:00', '--job-id', '57', '--raw', '--subdir', 'DAGS_FOLDER/pipeline.py', '--cfg-path', '/tmp/tmpdaq7riew', '--error-file', '/tmp/tmpf2tl338y']
[2023-11-22 19:16:36,452] {standard_task_runner.py:80} INFO - Job 57: Subtask load_core_dim_employer
[2023-11-22 19:16:36,579] {task_command.py:371} INFO - Running <TaskInstance: etl_hh.load_core_dim_employer scheduled__2023-11-21T00:00:00+00:00 [running]> on host 9ac5eb002233
[2023-11-22 19:16:36,765] {taskinstance.py:1591} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=etl_hh
AIRFLOW_CTX_TASK_ID=load_core_dim_employer
AIRFLOW_CTX_EXECUTION_DATE=2023-11-21T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-11-21T00:00:00+00:00
[2023-11-22 19:16:36,784] {base.py:68} INFO - Using connection ID 'my_db_conn' for task execution.
[2023-11-22 19:16:36,814] {dbapi.py:231} INFO - Running statement: 
        MERGE INTO core.dim_employer AS trg
        USING(
            SELECT DISTINCT 
                employer_id,
                employer_name
            FROM staging.vacancy) AS src
        ON trg.employer_id = src.employer_id
        WHEN NOT MATCHED
        THEN INSERT(
            employer_id,
            name)
        VALUES(
            src.employer_id,
            src.employer_name)
        WHEN MATCHED
                AND (COALESCE(trg.name, '') <> COALESCE(src.employer_name, '')
                OR trg.employer_id <> src.employer_id)
        THEN UPDATE
        SET 
            employer_id = src.employer_id, 
            name = src.employer_name, parameters: None
[2023-11-22 19:16:36,861] {taskinstance.py:1420} INFO - Marking task as SUCCESS. dag_id=etl_hh, task_id=load_core_dim_employer, execution_date=20231121T000000, start_date=20231122T191636, end_date=20231122T191636
[2023-11-22 19:16:36,905] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-11-22 19:16:37,068] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2023-11-22 19:18:53,691] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: etl_hh.load_core_dim_employer scheduled__2023-11-21T00:00:00+00:00 [queued]>
[2023-11-22 19:18:53,727] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: etl_hh.load_core_dim_employer scheduled__2023-11-21T00:00:00+00:00 [queued]>
[2023-11-22 19:18:53,728] {taskinstance.py:1376} INFO - 
--------------------------------------------------------------------------------
[2023-11-22 19:18:53,729] {taskinstance.py:1377} INFO - Starting attempt 1 of 2
[2023-11-22 19:18:53,730] {taskinstance.py:1378} INFO - 
--------------------------------------------------------------------------------
[2023-11-22 19:18:53,783] {taskinstance.py:1397} INFO - Executing <Task(PostgresOperator): load_core_dim_employer> on 2023-11-21 00:00:00+00:00
[2023-11-22 19:18:53,795] {standard_task_runner.py:52} INFO - Started process 691 to run task
[2023-11-22 19:18:53,802] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'etl_hh', 'load_core_dim_employer', 'scheduled__2023-11-21T00:00:00+00:00', '--job-id', '65', '--raw', '--subdir', 'DAGS_FOLDER/pipeline.py', '--cfg-path', '/tmp/tmpe9vh2yiy', '--error-file', '/tmp/tmpqmikb5zn']
[2023-11-22 19:18:53,804] {standard_task_runner.py:80} INFO - Job 65: Subtask load_core_dim_employer
[2023-11-22 19:18:54,031] {task_command.py:371} INFO - Running <TaskInstance: etl_hh.load_core_dim_employer scheduled__2023-11-21T00:00:00+00:00 [running]> on host 9ac5eb002233
[2023-11-22 19:18:54,423] {taskinstance.py:1591} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=etl_hh
AIRFLOW_CTX_TASK_ID=load_core_dim_employer
AIRFLOW_CTX_EXECUTION_DATE=2023-11-21T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-11-21T00:00:00+00:00
[2023-11-22 19:18:54,444] {base.py:68} INFO - Using connection ID 'my_db_conn' for task execution.
[2023-11-22 19:18:54,477] {dbapi.py:231} INFO - Running statement: 
        MERGE INTO core.dim_employer AS trg
        USING(
            SELECT DISTINCT 
                employer_id,
                employer_name
            FROM staging.vacancy) AS src
        ON trg.employer_id = src.employer_id
        WHEN NOT MATCHED
        THEN INSERT(
            employer_id,
            name)
        VALUES(
            src.employer_id,
            src.employer_name)
        WHEN MATCHED
                AND (COALESCE(trg.name, '') <> COALESCE(src.employer_name, '')
                OR trg.employer_id <> src.employer_id)
        THEN UPDATE
        SET 
            employer_id = src.employer_id, 
            name = src.employer_name, parameters: None
[2023-11-22 19:18:54,611] {taskinstance.py:1420} INFO - Marking task as SUCCESS. dag_id=etl_hh, task_id=load_core_dim_employer, execution_date=20231121T000000, start_date=20231122T191853, end_date=20231122T191854
[2023-11-22 19:18:54,713] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-11-22 19:18:54,858] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
